class "";

import ТББ_Базовый      classes КонстантыРолей;
import СИС2             classes Функции;

inclass


--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ЕстьТаблицаРазрядов(локНаимГруппы:string;var locGroup:Гарнец_ПерсоналБазовый.Справочники.Разряды):logical;
    with Query.Create([Гарнец_ПерсоналБазовый.Справочники.Разряды]) do
      Filter            = 'isGroup=1 and Наим="'+локНаимГруппы+'"';
      Select;
      Result            = not (Bof and Eof);
      if Result then
        locGroup        = Current;
      end;
      Close;
    end;
  end;
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func Загружено(локКодИсф:string):logical;
    with Query.Create([Гарнец_ПерсоналБазовый.Справочники.Разряды]) do
      Filter            = 'isGroup=0 and CodeISF="'+локКодИсф+'" and OurINN="'+Переменные.ИНН+'"';
      Select;
      Result            = not (Bof and Eof);
      Close;
    end;
  end;--func Загружено
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ЗагруженоВсе:logical;
    Result      = true;
    with Query.Create([ТБ69.ISF_РАЗР]) do
      Select;
      while not Eof do
        if not Загружено(Current.Код as string) then
           Result       = false;
           Break;
         end;
         Next;
      end;--while not Eof
    end;--with Query
  end;--func ЗагруженоВсе
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--



inobject

end