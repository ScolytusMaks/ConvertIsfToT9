class "";

inclass


--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
--@doc Проверка выполнения импорта для данного календаря
  func ИмпортКалендаряВыполнен(локКодИСФ:string;var локТипКалендаря:СИС2.ПользовательскийКалендарь.ТипКалендаря=nil):logical;
    if локТипКалендаря<>nil then
      with Query.Create([СИС2.ПользовательскийКалендарь.ТипКалендаря]) do
        Filter          = 'КОД="'+локТипКалендаря.Код+'" and RefISF.Exists(CodeISF="'+локКодИСФ+'" and OurINN="'+Переменные.ИНН+'")';
        Select;
        if not (Bof and Eof) then
          Result        = true;
        end;
        Close;
      end;--with Query
    else --принимающая запись не указана
      with Query.Create([СИС2.ПользовательскийКалендарь.ТипКалендаря]) do
        Filter          = 'RefISF.Exists(CodeISF="'+локКодИСФ+'" and OurINN="'+Переменные.ИНН+'")';
        Select;
        if not (Bof and Eof) then
          локТипКалендаря=Current as СИС2.ПользовательскийКалендарь.ТипКалендаря;
          Result        = true;
        end;
        Close;
      end;--with Query
    end;
  end;--func ИмпортКалендаряВыполнен
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ЗагруженоВсе:logical;
    Result              = true;
    with Query.Create([ТБ69.ISF_КАЛЕНДАРЬ]) do
      Filter            = 'Код<>"ДЕТИ"';
      Select;
      while not Eof do
        if not ИмпортКалендаряВыполнен(Current.Код as string) then
          Result        = false;
          Break;
        end;
        Next;
      end;--while not Eof
    end;--with Query
  end;--func ЗагруженоВсе
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--


inobject


end