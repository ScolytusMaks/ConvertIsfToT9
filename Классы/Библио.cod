class "";

import СИС2             Classes СтроковыеФункции,ФункцииДокумента;

inclass

--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ИсточникиФинансированияИСФ:string[2];  --[[Код,Наим]]
    var locClassRecord  : Class Record;
    locClassRecord              = FindClass('ТБ69.ISF_ИСТФИН') as Class Record;
    if locClassRecord<>nil then
      with Query.Create([locClassRecord]) do
        Select;
        while not Eof do
          Result[LengthOfArray(Result)+1]       = [Current.Код as string,Current.Наим as string];
          Next;
        end;
      end;
    end;
  end;--func ИсточникиФинансированияИСФ

--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ТипГрафикаПоКодуИсф(locCodeIsf:string):СИС2.ПользовательскийКалендарь.ТипКалендаря;
    Result              = QueryRecord(СИС2.ПользовательскийКалендарь.ТипКалендаря,'RefISF.Exists(CodeISF="'+locCodeIsf+'" and OurINN="'+Переменные.ИНН+'")') as СИС2.ПользовательскийКалендарь.ТипКалендаря;
  end;
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  --@doc Идентификация загруженных сотрудников выполняется по текущему в сеансе конвертации "Нашему" учреждению
  --@doc и табельному номеру, присвоенному ИСФ
  --@doc В параметр locRecord возвращается найденная запись
  func ЗагруженСотр(locTabIsf:string;var locRecord:Базовый.Данные.Субъект=nil):logical;
    locRecord           = QueryRecord(Базовый.Данные.Субъект,'НашеУчреждение='+Str(Переменные.ЗагруженноеУчреждение)+' and CodeISF="'+locTabIsf+'"') as Базовый.Данные.Субъект;
    Result              = locRecord<>nil;
  end;--proc func ЗагруженСотр
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ФизлицоИсфПоКлючу(locKey:integer) : Record;
    Result              = QueryRecord(FindClass('ТБ69.ISF_ФЛ') as Class Record,'DocId='+Str(locKey));
  end;--func ФизлицоИсфПоКлючу
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ДолжностьПоКодуИсф(locCodeIsf:string):Базовый.Справочники.РольСубъекта;
    Result = QueryRecord(Базовый.Справочники.РольСубъекта,'ЭтоДолжность=1 and (RefISF.Exists(CodeISF="'+locCodeIsf+'" and OurINN="'+Переменные.ИНН+'" and RoleOfRole=1))') as Базовый.Справочники.РольСубъекта;
  end;--func ДолжностьПоКодуИсф
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ЗваниеПоКодуИсф(locCodeIsf:string):Базовый.Справочники.РольСубъекта;
    Result = QueryRecord(Базовый.Справочники.РольСубъекта,'ЭтоДолжность in [4,5] and (RefISF.Exists(CodeISF="'+locCodeIsf+'"))') as Базовый.Справочники.РольСубъекта;
  end;--func ЗваниеПоКодуИсф
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ПодразделениеПоКодуИсф(locCodeIsf:string):Базовый.Данные.Субъект;
    Result = QueryRecord(Базовый.Данные.Субъект,'Подразделение=true and НашеУчреждение='+Str(Переменные.ЗагруженноеУчреждение)+' and CodeISF="'+locCodeIsf+'"') as Базовый.Данные.Субъект;
  end;--func ПодразделениеПоКодуИсф
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--
  func ФормаЗачисленияПоКодуИсф(locCodeIsf:string):Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления;
    if    locCodeIsf='ШТАТ' then
      Result    = QueryRecord(Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления,'Имя="Штат"') as Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления;
    elsif locCodeIsf='СВНУ' then
      Result    = QueryRecord(Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления,'Имя="Совместительство внутреннее"') as Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления;
    elsif locCodeIsf='СВНЕ' then
      Result    = QueryRecord(Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления,'Имя="Совместительство внешнее"') as Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления;
    elsif locCodeIsf='ПДРД' then
      Result    = QueryRecord(Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления,'Имя="Подряд"') as Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления;
    elsif locCodeIsf='ДЕТИ' then
      Result    = QueryRecord(Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления,'Имя="Штат"') as Гарнец_ПерсоналБазовый.Справочники.ФормаЗачисления;
    end;
  end;--func ФормаЗачисленияПоКодуИсф
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~--

inobject

end